features<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/features.txt", header = FALSE, sep = "")
X_training<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/train/X_train.txt", header = FALSE, sep = "")
y_training<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/train/y_train.txt", header = FALSE, sep = "")
X_test<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/test/X_test.txt", header = FALSE, sep = "")
y_test<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/test/y_test.txt", header = TRUE, sep = "")
subject_test<- read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/test/subject_test.txt", header = FALSE, sep = "")
subject_train<-read.table("~/Desktop/coursera/Getting and cleaning data/Peer review project/UCI HAR Dataset/train/subject_train.txt", header = FALSE, sep = "")
Z_combine<- rbind(X_test, X_training)
zz_combine<- rbind(y_test, y_training)
ZZ<- cbind(zz_combine, Z_combine)
subject<- rbind(subject_test, subject_train)
ZZZ<- cbind(subject, ZZ)
colnames(ZZZ) <- c("subject", "activity", features$V2)
Zs<- ZZZ %>% select(subject, activity, contains("mean"), contains("std"))
Zs$activity<- activity[Zs$activity, 2]
Zss<- arrange(Zs, subject)
names(Zss)<-gsub("Acc", "Accelerometer", names(Zss))
names(Zss)<-gsub("Gyro", "Gyroscope", names(Zss))
names(Zss)<-gsub("BodyBody", "Body", names(Zss))
names(Zss)<-gsub("Mag", "Magnitude", names(Zss))
names(Zss)<-gsub("^t", "Time", names(Zss))
names(Zss)<-gsub("^f", "Frequency", names(Zss))
names(Zss)<-gsub("tBody", "TimeBody", names(Zss))
names(Zss)<-gsub("-mean()", "Mean", names(Zss), ignore.case = TRUE)
names(Zss)<-gsub("-std()", "STD", names(Zss), ignore.case = TRUE)
names(Zss)<-gsub("-freq()", "Frequency", names(Zss), ignore.case = TRUE)
names(Zss)<-gsub("angle", "Angle", names(Zss))
names(Zss)<-gsub("gravity", "Gravity", names(Zss))
FinalData<- Zss %>% group_by(subject, activity) %>% summarise_all(funs(mean))
write.table(FinalData, "FinalData.txt", row.names = FALSE)
